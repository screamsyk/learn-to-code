# 栈

栈是一种 “操作受限” 的线性表数据结构，只允许在一端插入和删除数据。

栈由于只允许在一端插入和删除数据，所以有 `先进后出，后进先出` 的特性。如图：

![栈](img/stack.jpg)

栈可以通过 `数组` 和 `链表` 来实现，分为两类：

* `顺序栈`：用数组实现
* `链式栈`：用链表实现

所以内存使用上，既可以是连续的内存空间，又可以是零散的内存块。

## 一、基于数组实现的栈（顺序栈）

代码如下：

```java
// 基于数组实现的顺序栈
public class ArrayStack {
  private String[] items;  // 数组
  private int count;       // 栈中元素个数
  private int n;           //栈的大小

  // 初始化数组，申请一个大小为n的数组空间
  public ArrayStack(int n) {
    this.items = new String[n];
    this.n = n;
    this.count = 0;
  }

  // 入栈操作
  public boolean push(String item) {
    // 数组空间不够了，直接返回false，入栈失败。
    if (count == n) return false;
    // 将item放到下标为count的位置，并且count加一
    items[count] = item;
    ++count;
    return true;
  }
  
  // 出栈操作
  public String pop() {
    // 栈为空，则直接返回null
    if (count == 0) return null;
    // 返回下标为count-1的数组元素，并且栈中元素个数count减一
    String tmp = items[count-1];
    --count;
    return tmp;
  }
}
```

可以分析出，栈的时间复杂度为 `O(1)`

## 二、栈的实际应用

栈在软件工程和实际开发中有很多应用，如：`函数调用栈`、`表达式求值`、`表达式括号匹配`、`浏览器前进、后退`。

### 2.1 函数调用栈

操作系统会为每一个线程分配一块独立的内存空间，这些内存空间被组织成 `栈` 的结构。

在代码执行过程中，为了管理函数与函数之间的调用关系，就需要用到栈，即 `函数调用栈`。

当一个函数执行时，会将函数的相关变量压入栈，执行结束后，又出栈。

如函数 main 调用了另一个函数 add，那么得等 函数 add 执行完了，函数 main 才能执行完。

所以让函数 main 先进栈，函数 add 再进栈，这样等函数 add 执行结束出栈了，函数 main 才能出栈，这样就表现了函数之间的调用关系。

![函数调用栈](img/function-call-stack.jpg)